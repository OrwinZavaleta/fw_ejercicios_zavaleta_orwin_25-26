@if (!platoFavorito()) {
  <div id="detallesForm">
    <form
      class="row g-3 needs-validation"
      id="guardarOpinion"
      #opinionForm
      (ngSubmit)="handleSubmit()"
      novalidate
    >
      <h3>Formulario</h3>

      <div class="col-md-5">
        <h4>¿Ha hecho ya la receta?</h4>
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            id="quieroHacerla"
            name="estado"
            [(ngModel)]="estado"
            value="QUIERO_HACERLA"
            (change)="handleChangeEstado()"
            checked
          />
          <label for="QUIERO_HACERLA" class="form-check-label">Quiero hacerla</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            id="hecho"
            name="estado"
            [(ngModel)]="estado"
            value="LA_HE_HECHO"
            (change)="handleChangeEstado()"
          />
          <label for="LA_HE_HECHO" class="form-check-label">La he hecho</label>
        </div>
      </div>
      @if (estado === 'LA_HE_HECHO') {
        <div class="col-md-5">
          <h4>Calificación</h4>
          <div class="text-warning fs-3" [class.is-invalid]="!calificacion() && submited()">
            @for (j of [1, 2, 3, 4, 5]; track j) {
              <i
                class="bi me-2"
                (click)="handleCalificacion(j)"
                [class.bi-star]="j > (calificacion() ?? 0)"
                [class.bi-star-fill]="j <= (calificacion() ?? 0)"
              ></i>
            }
          </div>
          <div class="invalid-feedback">
            Ha marcado como Hecha, por favor deje una calificación.
          </div>
        </div>
      } @else {
        <div class="col-md-7"></div>
      }
      <div class="col-md-7">
        <label for="opinion" class="form-label fs-4">Su opinión</label>
        <textarea
          name="opinion"
          id="opinion"
          [(ngModel)]="opinion"
          class="form-control"
          rows="4"
          placeHolder="Escribanos su opinión."
        ></textarea>
      </div>
      <div class="col-md-12">
        <p><strong>Fecha de guardado:</strong> {{ saveDate() | date: 'mediumDate' }}</p>
      </div>
      @if (estadoGuardado()) {
        <div class="col-md-7">
          <div
            class="alert alert-dismissible fade show"
            role="alert"
            [class.alert-success]="estadoGuardado()?.tipo == 'success'"
            [class.alert-danger]="estadoGuardado()?.tipo == 'error'"
          >
            {{ estadoGuardado()?.mensaje }}
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="alert"
              aria-label="Close"
            ></button>
          </div>
        </div>
        <div class="col-md-5"></div>
      }
      <div class="col-md-6">
        <button type="submit" class="btn btn-primary">Guardar Cambios</button>
      </div>
      <div class="col-md-6">
        <button type="button" id="resetearForm" class="btn btn-outline-primary">Cancelar</button>
      </div>
    </form>
  </div>
}
